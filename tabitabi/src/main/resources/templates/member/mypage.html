<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>마이페이지</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <style>
body {
	margin: 0;
	padding: 0;
}

.header {
	display: flex;
	flex-direction: row;
	justify-content: space-between;
}

.page-title {
	display: flex;
	flex-direction: row;
	align-items: center;
	gap: 20px;
	
	cursor: pointer;
}

.title{
	font-size: 30px;
	font-weight: bold;
}

.logo{
	width: 70px;
	
	border-radius: 50px;
}

.page-container {
	display: flex;
	flex-direction: row;
	
	width: 100%;
	
}

.side-bar-container {
	flex: 1;
	
	display: flex;
	flex-direction: column;
	justify-content: center;
	align-items: center;
	
	gap: 30px;
}

.side-bar-container-title {
	font-size: 25px;
	font-weight: bold;
}

.side-bar-content-container {
	display: flex;
	flex-direction: column;
	justify-content: center;
	align-items: center;
	
	gap: 30px;
}

.side-bar-content {
	width: 100%;
	padding-bottom: 30px;
	border-bottom: 1px solid #ccc;
	
	cursor: pointer;
}

.side-bar-content:last-child {
	border-bottom: none;
}

.help-container {
	display: flex;
	flex-direction: column;
	justify-content: center;
	align-items: center;
}

.help-container-title {
	font-weight: bold;
}

.my-page-container {
	flex: 4;
	
	display: flex;
	flex-direction: column;
	justify-content: start;
	align-items: start;
	
	padding-top: 60px;
	padding-left: 30px;
	gap: 10px;
}

.my-page-contianer-title {
	font-weight: bold;
	width: 100%;
	padding-top: 10px;
	border-top: 5px solid #03C75A;
	padding-bottom: 10px;
	border-bottom: 5px solid #03C75A;
}

.my-data-content-container {
	display: flex;
	flex-direction: column;
	justify-content: center;
	align-items: center;
}

.my-data-content-box {
	display: flex;
	flex-direction: row;
	
	gap: 10px;

}
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  </head>
  <body>
<div id="header" class="header">
	<div id="page-title" class="page-title">
		<div id="title" class="title">쿠다몽</div>
		<img id="logo" class="logo" src="/images/kudamon.webp" alt="Kudamon">
	</div>
	<div>로그아웃</div>
</div>
    <div class="page-container">
      <div id="side-bar-container" class="side-bar-container">
        <div id="side-bar-container-title" class="side-bar-container-title">
          마이 쿠다몽
        </div>
        <div id="side-bar-content-container" class="side-bar-content-container">
          <div id="edit-my-data" class="edit-my-data side-bar-content">
            개인정보 수정
          </div>
          <div id="shipping-list" class="shipping-list side-bar-content">
            배송지 관리
          </div>
          <div id="order-list" class="order-list side-bar-content">
            주문 내역
          </div>
          <div id="cart-list" class="cart-list side-bar-content">장바구니</div>
          <div id="chat-list" class="chat-list side-bar-content">채팅 목록</div>
          <div
            id="zzim-product-list"
            class="zzim-product-list side-bar-content"
          >
            찜한 상품 목록
          </div>
          <div
            id="follow-seller-list"
            class="follow-seller-list side-bar-content"
          >
            팔로우한 판매자들
          </div>
        </div>
        <div id="help-container" class="help-container">
          <div id="help-container-title" class="help-container-title">
            도움이 필요하신가요?
          </div>
          <div id="help" class="help">1:1 문의하기</div>
        </div>
      </div>
      <div id="my-page-container" class="my-page-container">
        <div id="my-page-contianer-title" class="my-page-contianer-title"></div>
        <div
          id="my-page-content-container"
          class="my-page-content-container"
        >
        <img
          id="imagePreview"
          th:src="@{/uploads/{imageUrl}(imageUrl=${member.fileName})}"
          alt="Image Preview"
        />
        <input
          type="file"
          class="form-control"
          id="profile"
          name="profile"
          onchange="chooseImage(this)"
        />
        <button type="button" class="btn btn-primary" onclick="updateImage()">
          사진 변경
        </button>

        <form
          action="update"
          id="updateForm"
          method="POST"
          th:object="${member}"
        >
          <table>
            <tr>
              <th>이메일</th>
              <td>
                <input id="email" th:field="*{email}" readonly />
              </td>
            </tr>
            <tr>
              <th>비밀번호</th>
              <td>
                <input type="password" id="password" th:field="*{password}" />
                <div id="error-password" class="error"></div>
              </td>
            </tr>
            <tr>
              <th>이름</th>
              <td>
                <input type="text" id="name" th:field="*{name}" />
              </td>
            </tr>
            <tr>
              <th>성별</th>
              <td>
                <input th:field="*{gender}" readonly />
              </td>
            </tr>
            <tr>
              <th>주소</th>
              <td>
                <input id="address" th:field="*{address}" />
              </td>
            </tr>
            <tr>
              <th>비밀번호 찾기 질문</th>
              <td>
                <select id="question" onchange="updateQuestionValue()">
                  <th:block th:each="question : ${questions}">
                    <option
                      th:value="${question.name()}"
                      th:text="${question.questionText}"
                      th:selected="${question == defaultQu}"
                    ></option>
                  </th:block>
                </select>
                <input type="hidden" id="selected-question" name="question" />
              </td>
            </tr>
            <tr>
              <th>비밀번호 찾기 답변</th>
              <td>
                <input type="text" id="answer" th:field="*{answer}" />
              </td>
            </tr>
          </table>
          <p></p>
          <div class="my-page-button-box">
            <input type="submit" value="정보 수정하기" />
            <input type="button" onclick="pwCheck()" value="회원탈퇴" />
          </div>
        </form>
        </div>

        
      </div>
    </div>

    <!-- 
	  <div id="my-data-content-container" class="my-data-content-container">
	 	<div id="email-box" class="email-box my-data-content-box">
	 		<div id="email-title" class="email-title">이메일</div>
	 		<input type="email" id="email" value="" readonly />
	 	</div>
	 	<div id="password-box" class="password-box my-data-content-box">
	 		<div id="email-title" class="email-title">비밀번호</div>
	 		<input type="password" id="password" value="" />
		</div>
	 	<div id="name-box" class="name-box my-data-content-box">
	 		<div id="email-title" class="email-title">이름</div>
	 		<input type="text" id="name" value="" />
		</div>
	 	<div id="gender-box" class="gender-box my-data-content-box">
	 		<div id="gender-title" class="gender-title">성별</div>
	 		<input type="text" id="gender" value="" readonly />
		</div>
	 	<div id="address-box" class="address-box my-data-content-box">
	 		<div id="address-title" class="address-title">주소</div>
	 		<input type="text" id="address" value="" />
		</div>
	 	<div id="question-box" class="question-box my-data-content-box">
	 		<div id="question-title" class="question-title">비밀번호 찾기 질문</div>
	 		<input type="text" id="question" value="" />
		</div>
	 	<div id="answer-box" class="answer-box my-data-content-box">
	 		<div id="answer-title" class="answer-title">성별</div>
	 		<input type="text" id="answer" value="" />
		</div>
	  </div>
	  -->

    <script src="/js/mypage.js"></script>
    <script th:inline="javascript">
      window.onload = function(){
          // 요소에 클릭 이벤트 바인딩하기
           // 메인 페이지로
		   document.querySelector('#page-title').addEventListener('click', () => {
		   	window.location.href = `http://localhost:9000/kudamon/mall`;
		   })
    
          // 회원의 배송지 페이지
          document.querySelector('#shipping-list').addEventListener('click', () => {
        	  console.log("클릭");
      		let member_id = [[${member.id}]]; // 회원의 id 가져오기
      		window.location.href = `http://localhost:9000/member/address/${member_id}`;
          });

          // 장바구니 페이지
          document.querySelector('#cart-list').addEventListener('click', () => {
      		let member_id = [[${member.id}]]; // 회원의 id 가져오기
      		window.location.href = `http://localhost:9000/cart/${member_id}`;
          });

          // 주문 목록 페이지
          document.querySelector('#order-list').addEventListener('click', () => {
      		window.location.href = `http://localhost:9000/order/list`;
          });

          // 찜한 상품 페이지

          // 찜한 목록 페이지
      }

      const errorMessageContainer = () => {
      	document.querySelector('#my-page-content-container').innerHTML = `
      		<div id="error-message-container" class="error-message-container">에러 발생! 다시 시도해보세요.</div>
      	`;
      }

      const renderMyData = () => {
      	document.querySelector('#my-page-content-container').innerHTML = `

      	`;
      }

      $(document).ready(function() {
      	$('#edit-my-data').css('font-weight', 'bold');
      	$('#edit-my-data').css('color', '#03C75A');
      	$('#my-page-contianer-title').text('개인정보 수정');
      	/*

      	$('#edit-my-data').click(function() {
      		const url = `http://localhost:9000/member/myData`;
      		$.ajax({
      			url: url,
      			type: "GET",
      			success: function(response){
      				const orderId = response
      				console.log(orderId);
      				// window.location.href = url + `/${orderId}`; // 주문서 작성 페이지로 이동
      			},
      			error: function(xhr, status, error){
      				console.log("실패: ", error);
      				errorMessageContainer();
      			}
      		})
      	})
      	*/
      })
    </script>
  </body>
</html>
